// Code generated by templ - DO NOT EDIT.

// templ: version: v0.3.977
package auth

//lint:file-ignore SA4006 This context is only used if a nested component is present.

import "github.com/a-h/templ"
import templruntime "github.com/a-h/templ/runtime"

import (
	"fmt"
	"github.com/TheLab-ms/conway/modules/bootstrap"
	"net/url"
)

func renderLoginPage(callbackURI string, tso *TurnstileOptions) templ.Component {
	return templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
		templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
		if templ_7745c5c3_CtxErr := ctx.Err(); templ_7745c5c3_CtxErr != nil {
			return templ_7745c5c3_CtxErr
		}
		templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
		if !templ_7745c5c3_IsBuffer {
			defer func() {
				templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
				if templ_7745c5c3_Err == nil {
					templ_7745c5c3_Err = templ_7745c5c3_BufErr
				}
			}()
		}
		ctx = templ.InitializeContext(ctx)
		templ_7745c5c3_Var1 := templ.GetChildren(ctx)
		if templ_7745c5c3_Var1 == nil {
			templ_7745c5c3_Var1 = templ.NopComponent
		}
		ctx = templ.ClearChildren(ctx)
		if tso != nil {
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 1, "<script src=\"https://challenges.cloudflare.com/turnstile/v0/api.js\" async defer></script>")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 2, "<script src=\"/assets/webauthn.js\"></script>")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Var2 := templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
			templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
			templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
			if !templ_7745c5c3_IsBuffer {
				defer func() {
					templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
					if templ_7745c5c3_Err == nil {
						templ_7745c5c3_Err = templ_7745c5c3_BufErr
					}
				}()
			}
			ctx = templ.InitializeContext(ctx)
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 3, "<body class=\"d-flex align-items-center justify-content-center vh-100 bg-light p-3\"><div class=\"card shadow p-4\" style=\"max-width: 400px; width: 100%;\"><div id=\"login-email\" class=\"text-center\"><h5 class=\"mb-3\">Login or Signup</h5><!-- Passkey login button (shown if WebAuthn available) --><div id=\"passkey-login\" style=\"display: none;\"><button type=\"button\" class=\"btn btn-primary w-100 mb-3\" onclick=\"loginWithPasskey()\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"me-2\" viewBox=\"0 0 16 16\"><path d=\"M0 8a4 4 0 0 1 7.465-2H14a.5.5 0 0 1 .354.146l1.5 1.5a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0L13 9.207l-.646.647a.5.5 0 0 1-.708 0L11 9.207l-.646.647a.5.5 0 0 1-.708 0L9 9.207l-.646.647A.5.5 0 0 1 8 10h-.535A4 4 0 0 1 0 8m4-3a3 3 0 1 0 2.712 4.285A.5.5 0 0 1 7.163 9h.63l.853-.854a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.793-.793-1-1h-6.63a.5.5 0 0 1-.451-.285A3 3 0 0 0 4 5\"></path> <path d=\"M4 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0\"></path></svg> Sign in with Passkey</button><div id=\"passkey-error\" class=\"alert alert-danger mb-3\" style=\"display: none;\"></div><div class=\"d-flex align-items-center mb-3\"><hr class=\"flex-grow-1\"><span class=\"px-3 text-muted small\">or continue with email</span><hr class=\"flex-grow-1\"></div></div><form action=\"/login\" method=\"post\"><div class=\"mb-3\"><input type=\"email\" class=\"form-control\" id=\"email\" name=\"email\" placeholder=\"Email\" required></div><input type=\"hidden\" id=\"callback_uri\" name=\"callback_uri\" value=\"")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var3 string
			templ_7745c5c3_Var3, templ_7745c5c3_Err = templ.JoinStringErrs(callbackURI)
			if templ_7745c5c3_Err != nil {
				return templ.Error{Err: templ_7745c5c3_Err, FileName: `modules/auth/login.templ`, Line: 39, Col: 84}
			}
			_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var3))
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 4, "\"> ")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			if tso != nil {
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 5, "<div class=\"cf-turnstile mb-3\" data-sitekey=\"")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				var templ_7745c5c3_Var4 string
				templ_7745c5c3_Var4, templ_7745c5c3_Err = templ.JoinStringErrs(tso.SiteKey)
				if templ_7745c5c3_Err != nil {
					return templ.Error{Err: templ_7745c5c3_Err, FileName: `modules/auth/login.templ`, Line: 41, Col: 64}
				}
				_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var4))
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 6, "\"></div>")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 7, "<button type=\"submit\" class=\"btn btn-outline-primary w-100\">Continue with Email</button></form></div></div><script>\n\t\t\t\t(async function() {\n\t\t\t\t\tif (ConwayWebAuthn.isAvailable()) {\n\t\t\t\t\t\tdocument.getElementById('passkey-login').style.display = 'block';\n\t\t\t\t\t}\n\t\t\t\t})();\n\n\t\t\t\tasync function loginWithPasskey() {\n\t\t\t\t\tconst errorDiv = document.getElementById('passkey-error');\n\t\t\t\t\terrorDiv.style.display = 'none';\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst callbackUri = document.getElementById('callback_uri').value;\n\t\t\t\t\t\tawait ConwayWebAuthn.login(callbackUri);\n\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\tconsole.error('Passkey login failed:', err);\n\t\t\t\t\t\tif (err.name === 'NotAllowedError') {\n\t\t\t\t\t\t\terrorDiv.textContent = 'Passkey authentication was cancelled or timed out.';\n\t\t\t\t\t\t} else if (err.name === 'InvalidStateError') {\n\t\t\t\t\t\t\terrorDiv.textContent = 'No passkeys found. Please use email to sign in.';\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\terrorDiv.textContent = 'Passkey login failed. Please try email instead.';\n\t\t\t\t\t\t}\n\t\t\t\t\t\terrorDiv.style.display = 'block';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t</script></body>")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			return nil
		})
		templ_7745c5c3_Err = bootstrap.View().Render(templ.WithChildren(ctx, templ_7745c5c3_Var2), templ_7745c5c3_Buffer)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		return nil
	})
}

func renderLoginSentPage(email string) templ.Component {
	return templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
		templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
		if templ_7745c5c3_CtxErr := ctx.Err(); templ_7745c5c3_CtxErr != nil {
			return templ_7745c5c3_CtxErr
		}
		templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
		if !templ_7745c5c3_IsBuffer {
			defer func() {
				templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
				if templ_7745c5c3_Err == nil {
					templ_7745c5c3_Err = templ_7745c5c3_BufErr
				}
			}()
		}
		ctx = templ.InitializeContext(ctx)
		templ_7745c5c3_Var5 := templ.GetChildren(ctx)
		if templ_7745c5c3_Var5 == nil {
			templ_7745c5c3_Var5 = templ.NopComponent
		}
		ctx = templ.ClearChildren(ctx)
		templ_7745c5c3_Var6 := templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
			templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
			templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
			if !templ_7745c5c3_IsBuffer {
				defer func() {
					templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
					if templ_7745c5c3_Err == nil {
						templ_7745c5c3_Err = templ_7745c5c3_BufErr
					}
				}()
			}
			ctx = templ.InitializeContext(ctx)
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 8, "<body class=\"d-flex align-items-center justify-content-center vh-100 bg-light p-3\"><div id=\"login-code\" class=\"text-center\"><div class=\"card shadow p-4\" style=\"max-width: 400px;\"><h5 class=\"mb-3\">Check Your Email</h5>")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			if email != "" {
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 9, "<p class=\"text-muted mb-4\">We sent a login code to <strong>")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				var templ_7745c5c3_Var7 string
				templ_7745c5c3_Var7, templ_7745c5c3_Err = templ.JoinStringErrs(email)
				if templ_7745c5c3_Err != nil {
					return templ.Error{Err: templ_7745c5c3_Err, FileName: `modules/auth/login.templ`, Line: 85, Col: 46}
				}
				_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var7))
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 10, "</strong></p>")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
			} else {
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 11, "<p class=\"text-muted mb-4\">We sent a login code to your email address.</p>")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 12, "<form action=\"/login/code\" method=\"post\" id=\"code-form\"><label class=\"form-label\">Enter your 5-digit code</label><div class=\"d-flex justify-content-center gap-2 mb-3\"><input type=\"text\" class=\"form-control text-center code-digit\" maxlength=\"1\" pattern=\"[0-9]\" inputmode=\"numeric\" style=\"width: 50px; height: 60px; font-size: 24px;\" data-index=\"0\" autofocus> <input type=\"text\" class=\"form-control text-center code-digit\" maxlength=\"1\" pattern=\"[0-9]\" inputmode=\"numeric\" style=\"width: 50px; height: 60px; font-size: 24px;\" data-index=\"1\"> <input type=\"text\" class=\"form-control text-center code-digit\" maxlength=\"1\" pattern=\"[0-9]\" inputmode=\"numeric\" style=\"width: 50px; height: 60px; font-size: 24px;\" data-index=\"2\"> <input type=\"text\" class=\"form-control text-center code-digit\" maxlength=\"1\" pattern=\"[0-9]\" inputmode=\"numeric\" style=\"width: 50px; height: 60px; font-size: 24px;\" data-index=\"3\"> <input type=\"text\" class=\"form-control text-center code-digit\" maxlength=\"1\" pattern=\"[0-9]\" inputmode=\"numeric\" style=\"width: 50px; height: 60px; font-size: 24px;\" data-index=\"4\"></div><input type=\"hidden\" name=\"code\" id=\"code-value\"><div id=\"code-error\" class=\"text-danger mb-3\" style=\"display: none;\"></div><button type=\"submit\" class=\"btn btn-primary w-100\" id=\"submit-btn\" disabled>Verify Code</button></form><hr class=\"my-4\"><p class=\"text-muted small mb-0\">You can also click the link in your email to sign in.</p></div></div><script>\n\t\t\t\t(function() {\n\t\t\t\t\tconst digits = document.querySelectorAll('.code-digit');\n\t\t\t\t\tconst codeValue = document.getElementById('code-value');\n\t\t\t\t\tconst submitBtn = document.getElementById('submit-btn');\n\t\t\t\t\tconst form = document.getElementById('code-form');\n\n\t\t\t\t\tfunction updateCode() {\n\t\t\t\t\t\tlet code = '';\n\t\t\t\t\t\tdigits.forEach(d => code += d.value);\n\t\t\t\t\t\tcodeValue.value = code;\n\t\t\t\t\t\tsubmitBtn.disabled = code.length !== 5;\n\n\t\t\t\t\t\tif (code.length === 5) {\n\t\t\t\t\t\t\tform.submit();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tdigits.forEach((digit, index) => {\n\t\t\t\t\t\tdigit.addEventListener('input', (e) => {\n\t\t\t\t\t\t\tdigit.value = digit.value.replace(/[^0-9]/g, '');\n\t\t\t\t\t\t\tif (digit.value && index < 4) {\n\t\t\t\t\t\t\t\tdigits[index + 1].focus();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tupdateCode();\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tdigit.addEventListener('keydown', (e) => {\n\t\t\t\t\t\t\tif (e.key === 'Backspace' && !digit.value && index > 0) {\n\t\t\t\t\t\t\t\tdigits[index - 1].focus();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tdigit.addEventListener('paste', (e) => {\n\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\tconst paste = (e.clipboardData || window.clipboardData).getData('text');\n\t\t\t\t\t\t\tconst nums = paste.replace(/[^0-9]/g, '').slice(0, 5);\n\t\t\t\t\t\t\tfor (let i = 0; i < nums.length && i < 5; i++) {\n\t\t\t\t\t\t\t\tdigits[i].value = nums[i];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (nums.length > 0) {\n\t\t\t\t\t\t\t\tdigits[Math.min(nums.length, 4)].focus();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tupdateCode();\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t})();\n\t\t\t</script></body>")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			return nil
		})
		templ_7745c5c3_Err = bootstrap.View().Render(templ.WithChildren(ctx, templ_7745c5c3_Var6), templ_7745c5c3_Buffer)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		return nil
	})
}

func renderLoginEmail(self *url.URL, code string) templ.Component {
	return templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
		templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
		if templ_7745c5c3_CtxErr := ctx.Err(); templ_7745c5c3_CtxErr != nil {
			return templ_7745c5c3_CtxErr
		}
		templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
		if !templ_7745c5c3_IsBuffer {
			defer func() {
				templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
				if templ_7745c5c3_Err == nil {
					templ_7745c5c3_Err = templ_7745c5c3_BufErr
				}
			}()
		}
		ctx = templ.InitializeContext(ctx)
		templ_7745c5c3_Var8 := templ.GetChildren(ctx)
		if templ_7745c5c3_Var8 == nil {
			templ_7745c5c3_Var8 = templ.NopComponent
		}
		ctx = templ.ClearChildren(ctx)
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 13, "<div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\"><p>Here is your makerspace login code:</p><div style=\"text-align: center; margin: 30px 0;\"><div style=\"background-color: #f8f9fa; border-radius: 8px; padding: 20px; display: inline-block;\"><p style=\"margin: 0 0 10px 0; color: #666; font-size: 14px;\">Your login code:</p><div style=\"font-size: 36px; font-weight: bold; letter-spacing: 8px; color: #212529;\">")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var9 string
		templ_7745c5c3_Var9, templ_7745c5c3_Err = templ.JoinStringErrs(code)
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `modules/auth/login.templ`, Line: 170, Col: 11}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var9))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 14, "</div></div></div><p style=\"text-align: center; color: #666;\">Enter this code on the login page, or click the link below:</p><p style=\"text-align: center; margin: 20px 0;\"><a href=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var10 templ.SafeURL
		templ_7745c5c3_Var10, templ_7745c5c3_Err = templ.JoinURLErrs(templ.SafeURL(fmt.Sprintf("%s/login/code?code=%s", self.String(), code)))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `modules/auth/login.templ`, Line: 178, Col: 85}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var10))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 15, "\" style=\"background-color: #0d6efd; color: white; padding: 12px 24px; text-decoration: none; border-radius: 6px; display: inline-block;\">Sign In</a></p><p style=\"text-align: center; color: #999; font-size: 12px;\">Or copy this link: <a href=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var11 templ.SafeURL
		templ_7745c5c3_Var11, templ_7745c5c3_Err = templ.JoinURLErrs(templ.SafeURL(fmt.Sprintf("%s/login/code?code=%s", self.String(), code)))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `modules/auth/login.templ`, Line: 183, Col: 104}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var11))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 16, "\">")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var12 string
		templ_7745c5c3_Var12, templ_7745c5c3_Err = templ.JoinStringErrs(self.String())
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `modules/auth/login.templ`, Line: 183, Col: 122}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var12))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 17, "/login/code?code=")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var13 string
		templ_7745c5c3_Var13, templ_7745c5c3_Err = templ.JoinStringErrs(code)
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `modules/auth/login.templ`, Line: 183, Col: 147}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var13))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 18, "</a></p><hr style=\"margin: 30px 0; border: none; border-top: 1px solid #eee;\"><p style=\"color: #666; font-size: 14px;\">This code expires in 5 minutes.</p><p style=\"color: #999; font-size: 12px;\">If you did not request this login code, please ignore this message.</p></div>")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		return nil
	})
}

func renderPasskeyPrompt(callbackURI string) templ.Component {
	return templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
		templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
		if templ_7745c5c3_CtxErr := ctx.Err(); templ_7745c5c3_CtxErr != nil {
			return templ_7745c5c3_CtxErr
		}
		templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
		if !templ_7745c5c3_IsBuffer {
			defer func() {
				templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
				if templ_7745c5c3_Err == nil {
					templ_7745c5c3_Err = templ_7745c5c3_BufErr
				}
			}()
		}
		ctx = templ.InitializeContext(ctx)
		templ_7745c5c3_Var14 := templ.GetChildren(ctx)
		if templ_7745c5c3_Var14 == nil {
			templ_7745c5c3_Var14 = templ.NopComponent
		}
		ctx = templ.ClearChildren(ctx)
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 19, "<script src=\"/assets/webauthn.js\"></script>")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Var15 := templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
			templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
			templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
			if !templ_7745c5c3_IsBuffer {
				defer func() {
					templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
					if templ_7745c5c3_Err == nil {
						templ_7745c5c3_Err = templ_7745c5c3_BufErr
					}
				}()
			}
			ctx = templ.InitializeContext(ctx)
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 20, "<body class=\"d-flex align-items-center justify-content-center vh-100 bg-light p-3\"><div class=\"card shadow p-4\" style=\"max-width: 450px; width: 100%;\"><div class=\"text-center\"><div class=\"mb-4\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"48\" height=\"48\" fill=\"currentColor\" class=\"text-primary\" viewBox=\"0 0 16 16\"><path d=\"M0 8a4 4 0 0 1 7.465-2H14a.5.5 0 0 1 .354.146l1.5 1.5a.5.5 0 0 1 0 .708l-1.5 1.5a.5.5 0 0 1-.708 0L13 9.207l-.646.647a.5.5 0 0 1-.708 0L11 9.207l-.646.647a.5.5 0 0 1-.708 0L9 9.207l-.646.647A.5.5 0 0 1 8 10h-.535A4 4 0 0 1 0 8m4-3a3 3 0 1 0 2.712 4.285A.5.5 0 0 1 7.163 9h.63l.853-.854a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.646-.647a.5.5 0 0 1 .708 0l.646.647.793-.793-1-1h-6.63a.5.5 0 0 1-.451-.285A3 3 0 0 0 4 5\"></path> <path d=\"M4 8a1 1 0 1 1-2 0 1 1 0 0 1 2 0\"></path></svg></div><h5 class=\"mb-2\">Sign in faster next time</h5><p class=\"text-muted mb-4\">Set up a passkey to sign in instantly with Touch ID, Face ID, or your device PIN. No more waiting for email codes.</p><div id=\"passkey-support\"><button type=\"button\" class=\"btn btn-primary w-100 mb-2\" onclick=\"setupPasskey()\">Set up Passkey</button><div id=\"passkey-error\" class=\"alert alert-danger mb-2\" style=\"display: none;\"></div><div id=\"passkey-success\" class=\"alert alert-success mb-2\" style=\"display: none;\">Passkey created successfully!</div></div><a href=\"")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var16 templ.SafeURL
			templ_7745c5c3_Var16, templ_7745c5c3_Err = templ.JoinURLErrs(templ.SafeURL(getCallbackOrDefault(callbackURI)))
			if templ_7745c5c3_Err != nil {
				return templ.Error{Err: templ_7745c5c3_Err, FileName: `modules/auth/login.templ`, Line: 220, Col: 63}
			}
			_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var16))
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 21, "\" class=\"btn btn-link text-muted\" id=\"skip-link\" onclick=\"dismissPrompt()\">Not now</a></div></div><script>\n\t\t\t\tasync function setupPasskey() {\n\t\t\t\t\tconst errorDiv = document.getElementById('passkey-error');\n\t\t\t\t\tconst successDiv = document.getElementById('passkey-success');\n\t\t\t\t\terrorDiv.style.display = 'none';\n\t\t\t\t\tsuccessDiv.style.display = 'none';\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\tawait ConwayWebAuthn.register();\n\t\t\t\t\t\tsuccessDiv.style.display = 'block';\n\t\t\t\t\t\t// Redirect after short delay\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\twindow.location.href = document.getElementById('skip-link').href;\n\t\t\t\t\t\t}, 1500);\n\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\tconsole.error('Passkey setup failed:', err);\n\t\t\t\t\t\tif (err.name === 'NotAllowedError') {\n\t\t\t\t\t\t\terrorDiv.textContent = 'Setup was cancelled. You can try again or skip for now.';\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\terrorDiv.textContent = 'Failed to set up passkey. You can try again later from your profile.';\n\t\t\t\t\t\t}\n\t\t\t\t\t\terrorDiv.style.display = 'block';\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tasync function dismissPrompt() {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tawait ConwayWebAuthn.dismissPrompt();\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t// Ignore errors - user is navigating away anyway\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Hide setup if WebAuthn not available\n\t\t\t\t(function() {\n\t\t\t\t\tif (!ConwayWebAuthn.isAvailable()) {\n\t\t\t\t\t\tdocument.getElementById('passkey-support').innerHTML =\n\t\t\t\t\t\t\t'<p class=\"text-muted small\">Your browser doesn\\'t support passkeys.</p>';\n\t\t\t\t\t}\n\t\t\t\t})();\n\t\t\t</script></body>")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			return nil
		})
		templ_7745c5c3_Err = bootstrap.View().Render(templ.WithChildren(ctx, templ_7745c5c3_Var15), templ_7745c5c3_Buffer)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		return nil
	})
}

func getCallbackOrDefault(callback string) string {
	if callback == "" {
		return "/"
	}
	return callback
}

var _ = templruntime.GeneratedTemplate
